// query for supplies
SELECT
`supply`,
`code`,
COUNT(`supply`) as total,
    SUM(
        CASE WHEN `isAvailable` = 1 THEN 1 ELSE 0 END
    ) AS numberOfAvailable
FROM
    `supplies`
WHERE
    `model` = "Xerox_AltaLink_C8035"
    GROUP BY `supply`, `code`
    ORDER By `code`

// find by id query
SELECT
`printers`.*,
JSON_ARRAYAGG(JSON_OBJECT('id',`supplies`.`id`,
'supply',`supplies`.`supply`,
'code',`supplies`.`code`,
'isAvailable',`supplies`.`isAvailable`,
'model',`supplies`.`model`,
'storedAt',`supplies`.`storedAt`,
'installedAt',`supplies`.`installedAt`,
'printerId',`supplies`.`printerId`)) AS history
FROM
`printers`
join `supplies` ON
`printers`.`id` = `supplies`.`printerId`
GROUP BY `printers`.`id`
